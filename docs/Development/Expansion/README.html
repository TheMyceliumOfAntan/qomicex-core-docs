<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Expansion（扩展资源管理）解析教程 | Qomicex.Core API文档 </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Expansion（扩展资源管理）解析教程 | Qomicex.Core API文档 ">
      
      
      <link rel="icon" href="../../../favicon.ico">
      <link rel="stylesheet" href="../../../public/docfx.min.css">
      <link rel="stylesheet" href="../../../public/main.css">
      <meta name="docfx:navrel" content="../../../toc.html">
      <meta name="docfx:tocrel" content="../../toc.html">
      
      <meta name="docfx:rel" content="../../../">
      
      
      <meta name="docfx:docurl" content="https://github.com/TheMyceliumOfAntan/Qomicex.Avalonia/blob/main/Qomicex.Docs/docs/Development/Expansion/README.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../../../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../../index.html">
            <img id="logo" class="svg" src="../../../logo.svg" alt="Qomicex.Core">
            Qomicex.Core
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="expansion扩展资源管理解析教程">Expansion（扩展资源管理）解析教程</h1>

<h2 id="概述">概述</h2>
<p>Qomicex.Core 的 Expansion 模块提供了对第三方资源平台的支持，目前主要支持 CurseForge 和 Modrinth 两个资源平台。这两个平台都是 Minecraft 资源的主要分发渠道，提供了大量的 Mod、整合包、资源包和数据包。</p>
<h2 id="核心组件">核心组件</h2>
<h3 id="1-资源平台接口">1. 资源平台接口</h3>
<p>所有资源平台都实现了统一的接口，提供了一致的操作方法。</p>
<pre><code class="lang-csharp">using Qomicex.Core.Modules.Helpers.Resources.Expansion;

public interface IResourcePlatform
{
    // 搜索资源
    Task&lt;SearchResult&gt; SearchAsync(SearchQuery query);

    // 获取资源详情
    Task&lt;ResourceDetails&gt; GetResourceDetailsAsync(string resourceId);

    // 下载资源
    Task&lt;DownloadResult&gt; DownloadResourceAsync(string resourceId, string destinationPath);

    // 获取资源文件列表
    Task&lt;List&lt;ResourceFile&gt;&gt; GetResourceFilesAsync(string resourceId);
}
</code></pre>
<h3 id="2-curseforge-平台">2. CurseForge 平台</h3>
<pre><code class="lang-csharp">using Qomicex.Core.Modules.Helpers.Resources.Expansion.CurseForge;

// 创建 CurseForge 平台实例
var curseForge = new CurseForgePlatform(&quot;your-api-key&quot;);

// 搜索资源
var searchResult = await curseForge.SearchAsync(new SearchQuery
{
    Query = &quot;sodium&quot;,
    GameVersion = &quot;1.20.1&quot;,
    ResourceType = ResourceType.Mod
});

// 获取资源详情
var details = await curseForge.GetResourceDetailsAsync(&quot;394468&quot;); // Sodium Mod ID

// 下载资源
var downloadResult = await curseForge.DownloadResourceAsync(&quot;394468&quot;, @&quot;C:\Downloads\Sodium.jar&quot;);
</code></pre>
<h3 id="3-modrinth-平台">3. Modrinth 平台</h3>
<pre><code class="lang-csharp">using Qomicex.Core.Modules.Helpers.Resources.Expansion.Modrinth;

// 创建 Modrinth 平台实例
var modrinth = new ModrinthPlatform();

// 搜索资源
var searchResult = await modrinth.SearchAsync(new SearchQuery
{
    Query = &quot;sodium&quot;,
    GameVersion = &quot;1.20.1&quot;,
    ResourceType = ResourceType.Mod
});

// 获取资源详情
var details = await modrinth.GetResourceDetailsAsync(&quot;AANobbMI&quot;); // Sodium Mod ID

// 下载资源
var downloadResult = await modrinth.DownloadResourceAsync(&quot;AANobbMI&quot;, @&quot;C:\Downloads\Sodium.jar&quot;);
</code></pre>
<h2 id="资源类型">资源类型</h2>
<h3 id="1-资源类型枚举">1. 资源类型枚举</h3>
<pre><code class="lang-csharp">using Qomicex.Core.Modules.Helpers.Resources.Expansion;

public enum ResourceType
{
    Mod,              // 模组
    ModPack,          // 整合包
    ResourcePack,     // 资源包
    DataPack,         // 数据包
    ShaderPack        // 光影包
}
</code></pre>
<h3 id="2-搜索查询">2. 搜索查询</h3>
<pre><code class="lang-csharp">using Qomicex.Core.Modules.Helpers.Resources.Expansion;

var query = new SearchQuery
{
    Query = &quot;sodium&quot;,            // 搜索关键词
    GameVersion = &quot;1.20.1&quot;,      // 游戏版本
    ResourceType = ResourceType.Mod,  // 资源类型
    ModLoader = ModLoader.Fabric,     // 模组加载器
    Page = 0,                    // 页码
    PageSize = 20                // 每页大小
};
</code></pre>
<h2 id="资源搜索">资源搜索</h2>
<h3 id="1-基本搜索">1. 基本搜索</h3>
<pre><code class="lang-csharp">using Qomicex.Core.Modules.Helpers.Resources.Expansion.CurseForge;

var curseForge = new CurseForgePlatform(&quot;your-api-key&quot;);

var searchResult = await curseForge.SearchAsync(new SearchQuery
{
    Query = &quot;sodium&quot;,
    GameVersion = &quot;1.20.1&quot;,
    ResourceType = ResourceType.Mod
});

foreach (var result in searchResult.Results)
{
    Console.WriteLine($&quot;名称: {result.Name}&quot;);
    Console.WriteLine($&quot;作者: {result.Author}&quot;);
    Console.WriteLine($&quot;下载次数: {result.DownloadCount}&quot;);
    Console.WriteLine($&quot;评分: {result.Rating}&quot;);
    Console.WriteLine($&quot;描述: {result.Description}&quot;);
    Console.WriteLine();
}
</code></pre>
<h3 id="2-高级搜索">2. 高级搜索</h3>
<pre><code class="lang-csharp">using Qomicex.Core.Modules.Helpers.Resources.Expansion.CurseForge;

var curseForge = new CurseForgePlatform(&quot;your-api-key&quot;);

var searchResult = await curseForge.SearchAsync(new SearchQuery
{
    Query = &quot;sodium&quot;,
    GameVersion = &quot;1.20.1&quot;,
    ResourceType = ResourceType.Mod,
    ModLoader = ModLoader.Fabric,
    SortBy = SortType.DownloadCount,
    Page = 0,
    PageSize = 20
});

foreach (var result in searchResult.Results)
{
    Console.WriteLine($&quot;排名: {result.Rank}&quot;);
    Console.WriteLine($&quot;名称: {result.Name}&quot;);
    Console.WriteLine($&quot;下载次数: {result.DownloadCount}&quot;);
    Console.WriteLine($&quot;评分: {result.Rating}&quot;);
    Console.WriteLine($&quot;最后更新: {result.LastUpdated}&quot;);
    Console.WriteLine();
}
</code></pre>
<h2 id="资源详情获取">资源详情获取</h2>
<h3 id="1-获取资源基本信息">1. 获取资源基本信息</h3>
<pre><code class="lang-csharp">using Qomicex.Core.Modules.Helpers.Resources.Expansion.CurseForge;

var curseForge = new CurseForgePlatform(&quot;your-api-key&quot;);
var details = await curseForge.GetResourceDetailsAsync(&quot;394468&quot;);

Console.WriteLine($&quot;名称: {details.Name}&quot;);
Console.WriteLine($&quot;作者: {details.Author}&quot;);
Console.WriteLine($&quot;下载次数: {details.DownloadCount}&quot;);
Console.WriteLine($&quot;评分: {details.Rating}&quot;);
Console.WriteLine($&quot;描述: {details.Description}&quot;);
Console.WriteLine($&quot;游戏版本: {string.Join(&quot;, &quot;, details.SupportedVersions)}&quot;);
Console.WriteLine($&quot;Mod 加载器: {string.Join(&quot;, &quot;, details.SupportedModLoaders)}&quot;);
</code></pre>
<h3 id="2-获取资源文件列表">2. 获取资源文件列表</h3>
<pre><code class="lang-csharp">using Qomicex.Core.Modules.Helpers.Resources.Expansion.CurseForge;

var curseForge = new CurseForgePlatform(&quot;your-api-key&quot;);
var files = await curseForge.GetResourceFilesAsync(&quot;394468&quot;);

foreach (var file in files)
{
    Console.WriteLine($&quot;文件名: {file.FileName}&quot;);
    Console.WriteLine($&quot;下载链接: {file.DownloadUrl}&quot;);
    Console.WriteLine($&quot;大小: {file.Size}&quot;);
    Console.WriteLine($&quot;版本: {file.Version}&quot;);
    Console.WriteLine($&quot;游戏版本: {string.Join(&quot;, &quot;, file.SupportedVersions)}&quot;);
    Console.WriteLine($&quot;上传时间: {file.UploadedAt}&quot;);
    Console.WriteLine();
}
</code></pre>
<h2 id="资源下载">资源下载</h2>
<h3 id="1-基本下载">1. 基本下载</h3>
<pre><code class="lang-csharp">using Qomicex.Core.Modules.Helpers.Resources.Expansion.CurseForge;

var curseForge = new CurseForgePlatform(&quot;your-api-key&quot;);

var downloadResult = await curseForge.DownloadResourceAsync(
    &quot;394468&quot;,
    @&quot;C:\Downloads\Sodium.jar&quot;
);

if (downloadResult.IsSuccess)
{
    Console.WriteLine($&quot;下载成功！&quot;);
    Console.WriteLine($&quot;文件大小: {downloadResult.Size} bytes&quot;);
    Console.WriteLine($&quot;下载时间: {downloadResult.DownloadTime} ms&quot;);
}
else
{
    Console.WriteLine($&quot;下载失败: {downloadResult.ErrorMessage}&quot;);
}
</code></pre>
<h3 id="2-下载进度监控">2. 下载进度监控</h3>
<pre><code class="lang-csharp">using Qomicex.Core.Modules.Helpers.Resources.Expansion.CurseForge;

var curseForge = new CurseForgePlatform(&quot;your-api-key&quot;);

var downloadResult = await curseForge.DownloadResourceAsync(
    &quot;394468&quot;,
    @&quot;C:\Downloads\Sodium.jar&quot;,
    (progress, totalSize, downloadedSize) =&gt;
    {
        var percentage = (double)downloadedSize / totalSize * 100;
        Console.WriteLine($&quot;下载进度: {percentage:F2}% ({downloadedSize}/{totalSize} bytes)&quot;);
    }
);

if (downloadResult.IsSuccess)
{
    Console.WriteLine($&quot;下载成功！&quot;);
}
else
{
    Console.WriteLine($&quot;下载失败: {downloadResult.ErrorMessage}&quot;);
}
</code></pre>
<h2 id="资源管理">资源管理</h2>
<h3 id="1-资源缓存">1. 资源缓存</h3>
<pre><code class="lang-csharp">using Qomicex.Core.Modules.Helpers.Resources.Expansion;

// 配置资源缓存
var cacheOptions = new ResourceCacheOptions
{
    CacheLocation = @&quot;C:\Cache\Resources&quot;,
    MaxCacheSize = 10 * 1024 * 1024 * 1024, // 10GB
    CacheDuration = TimeSpan.FromDays(7)
};

// 使用缓存的平台实例
var curseForge = new CurseForgePlatform(&quot;your-api-key&quot;, cacheOptions);
</code></pre>
<h3 id="2-资源验证">2. 资源验证</h3>
<pre><code class="lang-csharp">using Qomicex.Core.Modules.Helpers.Resources.Expansion.CurseForge;

var curseForge = new CurseForgePlatform(&quot;your-api-key&quot;);

var isValid = await curseForge.VerifyResourceAsync(
    &quot;394468&quot;,
    @&quot;C:\Downloads\Sodium.jar&quot;
);

if (isValid)
{
    Console.WriteLine(&quot;资源验证成功！&quot;);
}
else
{
    Console.WriteLine(&quot;资源验证失败！&quot;);
}
</code></pre>
<h2 id="常见问题">常见问题</h2>
<h3 id="1-api-密钥问题">1. API 密钥问题</h3>
<p><strong>问题描述</strong>：CurseForge 平台需要 API 密钥，如何获取？</p>
<p><strong>解决方案</strong>：</p>
<ol>
<li>访问 CurseForge 开发者页面：https://console.curseforge.com/</li>
<li>注册或登录账号</li>
<li>创建新的 API 密钥</li>
<li>复制 API 密钥并在代码中使用</li>
</ol>
<h3 id="2-搜索结果为空">2. 搜索结果为空</h3>
<p><strong>问题描述</strong>：搜索资源时返回空结果。</p>
<p><strong>解决方案</strong>：</p>
<pre><code class="lang-csharp">using Qomicex.Core.Modules.Helpers.Resources.Expansion.CurseForge;

var curseForge = new CurseForgePlatform(&quot;your-api-key&quot;);

try
{
    var searchResult = await curseForge.SearchAsync(new SearchQuery
    {
        Query = &quot;sodium&quot;,
        GameVersion = &quot;1.20.1&quot;,
        ResourceType = ResourceType.Mod
    });

    if (searchResult.Results.Count == 0)
    {
        Console.WriteLine(&quot;未找到结果，请尝试调整搜索条件！&quot;);
    }
    else
    {
        foreach (var result in searchResult.Results)
        {
            Console.WriteLine($&quot;名称: {result.Name}&quot;);
        }
    }
}
catch (Exception ex)
{
    Console.WriteLine($&quot;搜索出错: {ex.Message}&quot;);
}
</code></pre>
<h3 id="3-下载失败">3. 下载失败</h3>
<p><strong>问题描述</strong>：下载资源时失败。</p>
<p><strong>解决方案</strong>：</p>
<pre><code class="lang-csharp">using Qomicex.Core.Modules.Helpers.Resources.Expansion.CurseForge;

var curseForge = new CurseForgePlatform(&quot;your-api-key&quot;);

try
{
    var downloadResult = await curseForge.DownloadResourceAsync(
        &quot;394468&quot;,
        @&quot;C:\Downloads\Sodium.jar&quot;
    );

    if (downloadResult.IsSuccess)
    {
        Console.WriteLine(&quot;下载成功！&quot;);
    }
    else
    {
        Console.WriteLine($&quot;下载失败: {downloadResult.ErrorMessage}&quot;);

        if (downloadResult.Retryable)
        {
            Console.WriteLine(&quot;可以重试下载！&quot;);
            // 重试下载
            downloadResult = await curseForge.DownloadResourceAsync(
                &quot;394468&quot;,
                @&quot;C:\Downloads\Sodium.jar&quot;
            );
        }
    }
}
catch (Exception ex)
{
    Console.WriteLine($&quot;下载出错: {ex.Message}&quot;);
}
</code></pre>
<h3 id="4-资源版本不匹配">4. 资源版本不匹配</h3>
<p><strong>问题描述</strong>：下载的资源版本与游戏版本不匹配。</p>
<p><strong>解决方案</strong>：</p>
<pre><code class="lang-csharp">using Qomicex.Core.Modules.Helpers.Resources.Expansion.CurseForge;

var curseForge = new CurseForgePlatform(&quot;your-api-key&quot;);

// 获取资源详情
var details = await curseForge.GetResourceDetailsAsync(&quot;394468&quot;);

// 检查是否支持所需版本
if (!details.SupportedVersions.Contains(&quot;1.20.1&quot;))
{
    Console.WriteLine($&quot;资源不支持 1.20.1 版本！&quot;);

    // 获取支持的版本列表
    Console.WriteLine($&quot;支持的版本: {string.Join(&quot;, &quot;, details.SupportedVersions)}&quot;);

    // 尝试获取其他版本
    var files = await curseForge.GetResourceFilesAsync(&quot;394468&quot;);
    var compatibleFiles = files.Where(f =&gt; f.SupportedVersions.Contains(&quot;1.20.1&quot;)).ToList();

    if (compatibleFiles.Any())
    {
        Console.WriteLine($&quot;找到 {compatibleFiles.Count} 个兼容的文件！&quot;);

        // 下载兼容的文件
        var downloadResult = await curseForge.DownloadResourceAsync(
            compatibleFiles[0].FileId,
            @&quot;C:\Downloads\Sodium.jar&quot;
        );
    }
}
else
{
    // 下载资源
    var downloadResult = await curseForge.DownloadResourceAsync(&quot;394468&quot;, @&quot;C:\Downloads\Sodium.jar&quot;);
}
</code></pre>
<h2 id="最佳实践">最佳实践</h2>
<h3 id="1-错误处理">1. 错误处理</h3>
<pre><code class="lang-csharp">using Qomicex.Core.Modules.Helpers.Resources.Expansion.CurseForge;

var curseForge = new CurseForgePlatform(&quot;your-api-key&quot;);

try
{
    var searchResult = await curseForge.SearchAsync(new SearchQuery
    {
        Query = &quot;sodium&quot;,
        GameVersion = &quot;1.20.1&quot;,
        ResourceType = ResourceType.Mod
    });

    foreach (var result in searchResult.Results)
    {
        Console.WriteLine($&quot;名称: {result.Name}&quot;);
    }
}
catch (ApiException ex)
{
    Console.WriteLine($&quot;API 错误: {ex.Message}&quot;);
    Console.WriteLine($&quot;状态码: {ex.StatusCode}&quot;);
}
catch (NetworkException ex)
{
    Console.WriteLine($&quot;网络错误: {ex.Message}&quot;);
}
catch (Exception ex)
{
    Console.WriteLine($&quot;未知错误: {ex.Message}&quot;);
    Console.WriteLine(ex.StackTrace);
}
</code></pre>
<h3 id="2-异步处理">2. 异步处理</h3>
<pre><code class="lang-csharp">using Qomicex.Core.Modules.Helpers.Resources.Expansion.CurseForge;

var curseForge = new CurseForgePlatform(&quot;your-api-key&quot;);

// 异步搜索资源
var searchTask = curseForge.SearchAsync(new SearchQuery
{
    Query = &quot;sodium&quot;,
    GameVersion = &quot;1.20.1&quot;,
    ResourceType = ResourceType.Mod
});

// 显示加载状态
Console.WriteLine(&quot;正在搜索资源...&quot;);

// 等待任务完成
await searchTask;

// 处理搜索结果
var searchResult = await searchTask;

foreach (var result in searchResult.Results)
{
    Console.WriteLine($&quot;名称: {result.Name}&quot;);
}
</code></pre>
<h3 id="3-资源缓存管理">3. 资源缓存管理</h3>
<pre><code class="lang-csharp">using Qomicex.Core.Modules.Helpers.Resources.Expansion;

var cacheOptions = new ResourceCacheOptions
{
    CacheLocation = @&quot;C:\Cache\Resources&quot;,
    MaxCacheSize = 10 * 1024 * 1024 * 1024,
    CacheDuration = TimeSpan.FromDays(7)
};

var curseForge = new CurseForgePlatform(&quot;your-api-key&quot;, cacheOptions);

// 清理过期缓存
await curseForge.ClearExpiredCacheAsync();

// 获取缓存统计信息
var cacheStats = curseForge.GetCacheStatistics();
Console.WriteLine($&quot;缓存文件数: {cacheStats.FileCount}&quot;);
Console.WriteLine($&quot;缓存大小: {cacheStats.TotalSize} bytes&quot;);
Console.WriteLine($&quot;命中率: {cacheStats.HitRate:F2}%&quot;);
</code></pre>
<h3 id="4-资源批量操作">4. 资源批量操作</h3>
<pre><code class="lang-csharp">using Qomicex.Core.Modules.Helpers.Resources.Expansion.CurseForge;

var curseForge = new CurseForgePlatform(&quot;your-api-key&quot;);

// 搜索并下载多个资源
var searchResult = await curseForge.SearchAsync(new SearchQuery
{
    Query = &quot;sodium&quot;,
    GameVersion = &quot;1.20.1&quot;,
    ResourceType = ResourceType.Mod
});

foreach (var result in searchResult.Results)
{
    try
    {
        var downloadResult = await curseForge.DownloadResourceAsync(
            result.ResourceId,
            Path.Combine(@&quot;C:\Downloads\Mods&quot;, $&quot;{result.Name}.jar&quot;)
        );

        if (downloadResult.IsSuccess)
        {
            Console.WriteLine($&quot;下载成功: {result.Name}&quot;);
        }
        else
        {
            Console.WriteLine($&quot;下载失败: {result.Name} - {downloadResult.ErrorMessage}&quot;);
        }
    }
    catch (Exception ex)
    {
        Console.WriteLine($&quot;处理资源 {result.Name} 时出错: {ex.Message}&quot;);
    }
}
</code></pre>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/TheMyceliumOfAntan/Qomicex.Avalonia/blob/main/Qomicex.Docs/docs/Development/Expansion/README.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          Qomicex.Avalonia
        </div>
      </div>
    </footer>
  </body>
</html>
